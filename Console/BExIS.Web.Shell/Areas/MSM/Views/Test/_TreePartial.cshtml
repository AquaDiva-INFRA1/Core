@using Telerik.Web.Mvc.UI
@model BExIS.Web.Shell.Areas.MSM.Models.TreePartialModel
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/angular.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/angular-route.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/angular-dragdrop.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/module.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/tree-repeat.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/zippy-directive.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Areas/MSM/Resources/Scripts/snippet.js")" type="text/javascript"></script>
@*<script src="https://rawgit.com/stackfull/angular-tree-repeat/master/src/module.js" type="text/javascript"></script>
<script src="https://rawgit.com/stackfull/angular-tree-repeat/master/src/tree-repeat.js" type="text/javascript"></script>*@


<h1>@Model.Name</h1>
@{
    string homeid = "#home" + Model.PartialId;
    string menuid = "#menu" + Model.PartialId;
    string home = "home" + Model.PartialId;
    string menu = "menu" + Model.PartialId;
    string controller = "SimpleCtrl" + Model.PartialId;
    string module = "module" + Model.PartialId;
    string dataModel = "model" + Model.PartialId;
    string listModel = "list" + Model.PartialId;
}
<ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="@homeid">Raw</a></li>
    <li><a data-toggle="tab" href="@menuid">Tree</a></li>
</ul>



<div class="tab-content">
    <div id="@home" class="tab-pane fade in active">
        <p>
            @Model.Xsd
        </p>
    </div>
    <div id="@menu" class="tab-pane fade">
        <p>

            <div ng-controller="SimpleCtrl" data-model="@dataModel" data-listmodel="@listModel">

                <ul>
                    <li sf-treepeat="node in sequence of treeData">
                        <div data-drag="true" data-jqyoui-options="{revert: 'invalid', helper: 'clone'}"
                            jqyoui-draggable="{animate: true, placeholder: 'keep'}">
                            {{node.name}}
                        </div>
                        @*<zippy title="{{node.name}}">*@
                        <ul>
                            <li sf-treecurse >This should be removed</li>
                        </ul>
                        @*</zippy>*@
                    </li>
                </ul>
                <div>
                    <ul style="background-color:blue;" data-drop="true" ng-model='@listModel' jqyoui-droppable="{multiple:true}">
                        <li ng-repeat="item in @listModel track by $index" ng-show="item.name" data-drag="true" data-jqyoui-options="{revert: 'invalid', helper: 'clone'}"
                            ng-model="@listModel"
                            jqyoui-draggable="{index: {{index}},animate:true}">{{item.name}}</li>
                        <li class="placeholder" ng-hide="hideMe()">Add your items here</li>
                    </ul>
                </div>
                <pre>
  {{@listModel | json}}
</pre>
            </div>

            @*<div ng-controller="oneCtrl">
                <ul>
                    <li ng-repeat='item in list1' ng-show="item.name" data-drag="true" data-jqyoui-options="{revert: 'invalid', helper: 'clone'}" ng-model="list1" jqyoui-draggable="{index: {{$index}}, animate: true, placeholder: 'keep'}">{{item.name}}</li>
                    
                </ul>
            </div>  *@
        </p>
    </div>




    @*    @(Html.Telerik().TreeView()
        .Name("Metadata_TreeView")
        .ShowCheckBox(true)
        .BindTo(new TreeViewItemModel[] { Model.xmlTree })
        .ExpandAll(true)
    )*@
    <script type="text/javascript">
        dataModels["@dataModel"]=@Html.Raw(Model.JsonTreeView);
        //console.log(dataModels);
        //alert(JSON.stringify(dataModels["@dataModel"]));
        @*App.value("model",@Html.Raw(Model.JsonTreeView));
     *@
        //var App = angular.module('drag-and-drop', ['ngDragDrop']);

        @* App.controller('oneCtrl', function ($scope, $timeout) {
            
            $scope.list1 =@Html.Raw(Model.JsonTreeView);
            $scope.list4 = [];

            $scope.hideMe = function () {
                return $scope.list4.length > 0;
            }
        });*@
       
        //$(function () {
        //    $('#treeView li > ul').each(function (i) {
        //        var parent_li = $(this).parent('li');
        //        var sub_ul = $(this).remove();
        //        parent_li.wrapInner('<a/>').find('a').click(function () {
        //            sub_ul.toggle();
        //        });
        //        parent_li.append(sub_ul);
        //    });
        //    $('ul ul').hide();
        //});
    </script>
