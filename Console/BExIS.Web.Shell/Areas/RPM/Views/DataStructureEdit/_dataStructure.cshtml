@using Telerik.Web.Mvc.UI
@using BExIS.Web.Shell.Areas.RPM.Models
@model BExIS.Web.Shell.Areas.RPM.Models.DataStructurePreviewModel

<div class="bx-rpm-datastructureheader">
    <h3>
            @if (Model.inUse)
            {
                <span class="bx-rpm-headline" id="headlineId"><span class="bx bx-lock" id="headlineLock"></span>(@Model.Id)</span>
            }
            else
            {
                <span class="bx-rpm-headline" id="headlineId">(@Model.Id)</span>
            }
            @(Html.TextBoxFor(m => Model.Name, new { @class = "bx-rpm-headlinetextbox", @placeholder = "Data Structure Name" }))
    </h3>
        @(Html.TextAreaFor(m => Model.Description, new { @class = "bx-rpm-headlinetextarea", @placeholder = "Data Structure Name" }))
</div>
<div class="bx-rpm-variable-container">
    @foreach (AttributePreviewStruct v in Model.VariablePreviews)
    {
        string Id = v.Id + "_variable";
        <div class="bx-rpm-variable-item" id="@Id">
            <table>
                <tr>
                    <td class="bx-rpm-label"><label>Name</label></td>
                    <td class="name bx-rpm-text">@v.Name</td>
                    <td class="bx-rpm-label" rowspan="2"><label>Description</label></td>
                    <td class="description bx-rpm-text" rowspan="2">@v.Description</td>
                </tr>
                <tr>
                    <td class="bx-rpm-label"><label>Id</label></td>
                    <td class="id bx-rpm-text">@v.Id</td>
                </tr>
                <tr>
                    <td class="bx-rpm-label"><label>Unit</label></td>
                    <td class="unit bx-rpm-text">@v.Unit</td>
                    <td class="bx-rpm-label" rowspan="2"><label>Constraints</label></td>
                    <td class="description bx-rpm-text" rowspan="2">
                        @foreach (string s in v.Constraints)
                        {
                            <p>@s</p>
                        }
                    </td>
                </tr>
                <tr>
                    <td class="bx-rpm-label"><label>Data Type</label></td>
                    <td class="datatype bx-rpm-text">@v.DataType</td>
                </tr>
            </table>
        </div>
    }
</div>

<script type="text/javascript">
    $(function () {
        resizeVariableContainer(120);
    });

    $(window).resize(function () {
        resizeVariableContainer(120)
    });

    function resizeVariableContainer(delay) {
        setTimeout(function () {
            $('.bx-rpm-headlinetextbox').width(getHeadLineTextBoxSize());
            $('.bx-rpm-variable-container').height(getVariableContainerSize());
        }, delay);
    }

    function getHeadLineTextBoxSize() {
        return $('.bx-rpm-datastructureheader').width() - $('#headlineId').width() - 20;
    }

    function getVariableContainerSize() {
        return $(window).height() - $('.bx-rpm-datastructureheader').height() - 150;
    }
</script>