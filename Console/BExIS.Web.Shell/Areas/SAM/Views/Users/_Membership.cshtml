@using BExIS.Modules.Sam.UI.Models
@using Telerik.Web.Mvc.UI

@(Html.Telerik().Grid<UserMembershipGridRowModel>()
    .Name("gridMembership")
    .Columns(columns =>
    {
        columns.Bound(m => m.IsUserInGroup)
            .Template(@<text>
                @if(item.IsUserInGroup)
                {
                    <input type='checkbox' onchange='setMembership(this.checked, @item.Id);' name='selectedGroups' value='@item.Id' checked='checked' />
                }
                else
                {
                    <input type='checkbox' onchange='setMembership(this.checked, @item.Id);' name='selectedGroups' value='@item.Id' />
                }
            </text>)
            .ClientTemplate("<input type='checkbox' onchange='setMembership(this.checked, <#= Id #>);' name='selectedGroups' value='<#= Id #>' <#= IsUserInGroup ? checked='checked' : '' #> />")
            .Title("Member")
            .Width(64)
            .Filterable(false)
            .HtmlAttributes(new { style = "text-align:center" });
        columns.Bound(m => m.Id)
            .ClientTemplate("<#= Id #>" + "<input type='hidden' name='Id' value='<#= Id #> />'")
            .Width(80);
        columns.Bound(m => m.GroupName);
        columns.Bound(m => m.Description);
    })
        .ClientEvents(clientEvents =>
        {
            clientEvents.OnDataBound("gridMembership_onDataBound");
        })
        .DataBinding(dataBinding => dataBinding
            .Ajax()
            .OperationMode(GridOperationMode.Client)
            .Select("Membership_Select", "Users", new { id = Model.UserId, selectedGroups = (long[])ViewData["Groups"] })
        )
        .Filterable()
        .Pageable(pageable =>
        {
            pageable.PageSize(10, new[] { 10, 20, 50, 100 });
            pageable.Style(GridPagerStyles.NextPreviousAndNumeric | GridPagerStyles.PageSizeDropDown);
            pageable.Position(GridPagerPosition.Both);
        })
        .Sortable())