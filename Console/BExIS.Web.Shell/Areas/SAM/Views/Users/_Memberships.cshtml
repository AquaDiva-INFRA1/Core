@using BExIS.Modules.Sam.UI.Models
@using Telerik.Web.Mvc.UI

@model long

@(Html.Telerik().Grid<UserMembershipGridRowModel>()
    .Name("gridMembership")
    .Columns(columns =>
    {
        columns.Bound(g => g.IsMember)
            .Template(@<text>
            @if (item.IsMember)
            {
                <input type='checkbox' name='selectedGroups' value='@item.Id' checked='checked' />
            }
            else
            {
                <input type='checkbox' name='selectedGroups' value='@item.Id' />
            }
            </text>)
            .ClientTemplate("<input type='checkbox' name='selectedGroups' value='<#= Id #>' <#= IsMember ? checked='checked' : '' #> />")
            .Title("Member")
            .Width(64)
            .Filterable(false)
            .HtmlAttributes(new { style = "text-align:center" });
        columns.Bound(g => g.Id);
        columns.Bound(g => g.Name);
        columns.Bound(g => g.GroupType);
        columns.Bound(g => g.Description);
    })
    .ClientEvents(events =>
    {
        events.OnDataBound("onDataBound");
        events.OnDataBinding("onDataBinding");
    })
    .DataBinding(dataBinding => dataBinding
        .Ajax()
        .Select("Memberships_Select", "Users")
    )
    .EnableCustomBinding(true)
    .Filterable()
    .Pageable(pageable =>
    {
        pageable.PageSize(10, new[] { 10, 20, 50, 100 });
        pageable.Style(GridPagerStyles.NextPreviousAndNumeric | GridPagerStyles.PageSizeDropDown);
        pageable.Position(GridPagerPosition.Bottom);
    })
      .Sortable(sortable => sortable.OrderBy(order => order.Add(c => c.Id).Descending())))

<div class="bx-footer right">
    <button style="margin-right: 1px" type="button" id="button_membership_save" class="bx-button action">Save</button>
    <button style="margin-left: 1px" type="button" class="bx-button action">Cancel</button>
</div>

<script>
    $("#button_membership_save").click(function () {
        $("#gridFeaturePermissions tbody").preloader(40, "Update", 300);
        $.post('@Url.Action("Memberships_Save", "Users")', { Selection: getSelection(), UserId: @Model }, function () {
            $('#windowMembership').data('tWindow').close();
            $("#gridFeaturePermissions .t-refresh").trigger('click');
            $("#gridFeaturePermissions tbody").removePreloader();

        });
    });
</script>
