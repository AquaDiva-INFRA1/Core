@using BExIS.Modules.Sam.UI.Models
@using Telerik.Web.Mvc.UI
@model long

@Html.ActionLink("Create Entity Permission", "Create", "EntityPermissions", null, new { @class = "bx-button function" })

@(Html.Telerik().Grid<EntityPermissionGridRowModel>().Name("gridUsers")
    .Columns(columns =>
    {
        columns.Bound(u => u.Id);
        columns.Bound(u => u.EntityId);
        columns.Bound(u => u.Key);
        columns.Bound(u => u.SubjectId);
        columns.Bound(u => u.SubjectName);
        columns.Bound(u => u.SubjectName);
        columns.Bound(u => u.Rights);
        columns.Template(@<text>
                             <button type="button" class="bx bx-grid-function bx-edit" onclick="editEntityPermission(@item.Id)"></button>
                             <button type="button" class="bx bx-grid-function bx-trash" onclick="deleteEntityPermission(@item.Id)"></button>
                          </text>)
            .ClientTemplate(
                "<button type=\"button\" class=\"bx bx-grid-function bx-edit\" onclick=\"editEntityPermission(<#= Id #>);\" value=\"<#= Id #>\"></button>" +
                "<button type=\"button\" class=\"bx bx-grid-function bx-trash\" onclick=\"deleteEntityPermission(<#= Id #>);\" value=\"<#= Id #>\"></button>")
            .Width(70);
    })
    .ClientEvents(events =>
    {
        events.OnDataBound("onDataBound");
    })
    .DataBinding(dataBinding => dataBinding
        .Ajax()
        .Select("EntityPermissions_Select", "EntityPermissions", new { EntityId = Model })
    )
    .EnableCustomBinding(true).Filterable().Pageable(pageable =>
    {
        pageable.PageSize(10, new[] { 10, 20, 50, 100 });
        pageable.Style(GridPagerStyles.NextPreviousAndNumeric | GridPagerStyles.PageSizeDropDown);
        pageable.Position(GridPagerPosition.Both);
    })
    .Sortable()
)

<script type="text/javascript">

    function onDataBound() {
        addTooltips();
        resetAllTelerikIconTitles();
    }
</script>