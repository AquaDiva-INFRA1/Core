@model BExIS.Web.Shell.Areas.DCM.Models.ChooseDatasetViewModel
@using Telerik.Web.Mvc.UI;
@using Telerik.Web.Mvc.Resources;
@using BExIS.Web.Shell.Areas.DCM.Models;

@{
    if (this.ViewContext.FormContext == null)
    {
        this.ViewContext.FormContext = new FormContext();
    }

    ListViewItem selectedListeViewitem = new ListViewItem();
    if (@Model.SelectedDatasetId > 0)
    {
        selectedListeViewitem.Id = Model.SelectedDatasetId;
        selectedListeViewitem.Title = Model.DatasetTitle;
    }
}

<script>
    $(document).ready(function () {
        $("input:radio[name=sheetFormat]:first").attr('checked', true);
    });
</script>
<style>
    div.sheetSelect label > img {
        width: 100px;
    }
    div.sheetSelect label > input{
        display: none;
    }
    div.sheetSelect label > input + img{ 
        cursor: pointer;
        border: 2px solid transparent;
    }
    div.sheetSelect label > input:checked + img{
        border: 6px solid rgba(255, 165, 0, 0.7);
        border-radius: 4px;
        width: 140px;
    }
</style>

<div id="Step3" class="uploadWizardStep">

    <div class="uploadWizardStep_Main">
        <div class="uploadWizardStep_Header stepper">
            <h3>@Model.StepInfo.title</h3>
        </div>

        <div class="uploadWizardStep_Description stepper">
            <p>Your uploaded file got a specific structure, please select which one.
            </p>
        </div>

        <div class="uploadWizardStep_Content stepper">
            <div class="sheetSelect">
                <label>
                    <input type="radio" name="sheetFormat" value="top-down" />
                    <img src="~/Areas/DCM/Images/DCM_SelectAreas/top-down.png">
                </label>

                <label>
                    <input type="radio" name="sheetFormat" value="left-right" />
                    <img src="~/Areas/DCM/Images/DCM_SelectAreas/left-right.png">
                </label>

                <label>
                    <input type="radio" name="sheetFormat" value="matrix" />
                    <img src="~/Areas/DCM/Images/DCM_SelectAreas/matrix.png">
                </label>
            </div>
        </div>
    </div>

    <div class="uploadWizardStep_Error stepper">
        @if (Model != null)
        {
            if (Model.ErrorList != null)
            {
                if (Model.ErrorList.Count == 0)
                {


                }
                else
                { 
                   <ul>
                        @foreach (BExIS.IO.Transform.Validation.Exceptions.Error s in @Model.ErrorList)
                        { 
                            <li>@s.ToString()</li>
                        }
                   </ul>

                }
            }

        }
    </div>   
</div>


<script type="text/javascript">

    $('input[type=radio][name=sheetFormat]').change(function () {

        if ($(this).val() > 0) {
            // TODO
           
            SelectedDatasetId = $(this).val();
            SelectedDatasetTitle = "test";
            //Parameters.push("DatasetId:" + SelectedDatasetId);
            //Parameters.push("DatasetTitle:" + SelectedDatasetTitle);

            // send to bus
            $.post('@Url.Action("AddSelectedDatasetToBus", "SubmitSpecifyDataset", new RouteValueDictionary { { "area", "DCM" } })', { id: SelectedDatasetId }, function (response) {
                $("#Step3").html(response);
            })
        }

    })

</script>